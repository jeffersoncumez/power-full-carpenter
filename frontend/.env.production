import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import dotenv from 'dotenv';
import path from 'path';

// ‚úÖ Determinar el entorno (por defecto 'production' en Vercel)
const mode = process.env.NODE_ENV || 'production';

// ‚úÖ Cargar manualmente el archivo correspondiente (.env.production)
const envFile = path.resolve(process.cwd(), `.env.${mode}`);
dotenv.config({ path: envFile });

// ‚úÖ Mostrar en logs del build qu√© archivo y valor se us√≥
console.log("===========================================");
console.log(`üîç Cargando variables desde: ${envFile}`);
console.log("üåç VITE_API_URL detectada:", process.env.VITE_API_URL || "(no detectado)");
console.log("===========================================");

export default defineConfig({
  plugins: [react()],
  define: {
    // ‚úÖ Inyectar expl√≠citamente la variable para que est√© disponible en import.meta.env
    'import.meta.env.VITE_API_URL': JSON.stringify(process.env.VITE_API_URL),
  },
  build: {
    outDir: 'dist',
  },
});
